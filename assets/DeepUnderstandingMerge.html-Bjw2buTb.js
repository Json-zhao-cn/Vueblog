import{_ as n,c as t,a as i,o}from"./app-BWHYZH_D.js";const a={};function r(s,e){return o(),t("div",null,[...e[0]||(e[0]=[i('<h2 id="deep-understanding-of-the-operation-mechanism-of-merge-in-sql-server" tabindex="-1"><a class="header-anchor" href="#deep-understanding-of-the-operation-mechanism-of-merge-in-sql-server"><span>Deep understanding of the operation mechanism of merge in SQL Server</span></a></h2><h3 id="_1-what-is-merge-into" tabindex="-1"><a class="header-anchor" href="#_1-what-is-merge-into"><span>1. What is merge into?</span></a></h3><p>In the official document explanation,<code>MERGE INTO</code> (also known as UPSERT) is a feature introduced in SQL Server 2008, which allows <code>INSERT</code>, <code>UPDATE</code> and <code>DELETE</code> operations to be performed in a single statement. In a word, it is sql script can execute <code>INSERT</code>, <code>UPDATE</code> and <code>DELETE</code>.</p><h3 id="_2-why-we-need-to-use-merge-into" tabindex="-1"><a class="header-anchor" href="#_2-why-we-need-to-use-merge-into"><span>2. Why we need to use merge into?</span></a></h3><ol><li>Traditionally, if we want compare two tables differences. Most of time, we will use complicate sql script or stored procedure to do it.Now, we can use merge into to simple realize it.</li><li>Merge into just generate only one transcation log. And the transcation log is equal to total mount of the insert, update and delete transaction logs.</li></ol><h3 id="_3-merge-into-execute-process" tabindex="-1"><a class="header-anchor" href="#_3-merge-into-execute-process"><span>3. Merge into execute process</span></a></h3><ol><li>Only perform a full table scan once</li><li>Join table based on the condition(<code>It is better has some indexes in your condition</code>)</li><li><strong>Data partition</strong> Dividing it into three operations(Unpdate,Insert, delete);</li><li>Each rows will check the PK and FK constraints;</li><li>Commit transcation(Only one)</li></ol><h3 id="_4-merge-into-disadvantage" tabindex="-1"><a class="header-anchor" href="#_4-merge-into-disadvantage"><span>4. Merge into disadvantage</span></a></h3><ol><li><strong>High quality with developer</strong>:The developer must familar with SQL, if the condition has no index, very slowly;</li><li><strong>Index constraint</strong>:It is best that the table does not have foreign keys or triggers.(Index constraint)</li><li><strong>Lock</strong>:Big data has large lock;</li></ol><h3 id="_5-merge-into-benefit" tabindex="-1"><a class="header-anchor" href="#_5-merge-into-benefit"><span>5. Merge into benefit</span></a></h3><ol><li><strong>Readability</strong>:Simple code, easy read and understand;</li><li><strong>Transaction atomicity</strong>: One transcation and data consistency;</li><li><strong>High-performance</strong>: Reduce scan table and I/O read;</li><li><strong>Compalicated Logic handling</strong>:Can deal with complicated logic;</li><li><strong>Batch deal</strong>: Big data small batch deal;</li></ol>',11)])])}const d=n(a,[["render",r]]),c=JSON.parse('{"path":"/blogs/Skills/SQLServer/Funcation/DeepUnderstandingMerge.html","title":"Deep understanding of the operation mechanism of merge in SQL Server","lang":"en-US","frontmatter":{"title":"Deep understanding of the operation mechanism of merge in SQL Server","date":"2025/11/20","tags":["SQLServer"],"categories":["Skills"]},"headers":[{"level":2,"title":"Deep understanding of the operation mechanism of merge in SQL Server","slug":"deep-understanding-of-the-operation-mechanism-of-merge-in-sql-server","link":"#deep-understanding-of-the-operation-mechanism-of-merge-in-sql-server","children":[{"level":3,"title":"1. What is merge into?","slug":"_1-what-is-merge-into","link":"#_1-what-is-merge-into","children":[]},{"level":3,"title":"2. Why we need to use merge into?","slug":"_2-why-we-need-to-use-merge-into","link":"#_2-why-we-need-to-use-merge-into","children":[]},{"level":3,"title":"3. Merge into execute process","slug":"_3-merge-into-execute-process","link":"#_3-merge-into-execute-process","children":[]},{"level":3,"title":"4. Merge into disadvantage","slug":"_4-merge-into-disadvantage","link":"#_4-merge-into-disadvantage","children":[]},{"level":3,"title":"5. Merge into benefit","slug":"_5-merge-into-benefit","link":"#_5-merge-into-benefit","children":[]}]}],"git":{"createdTime":1763625686000,"updatedTime":1763625686000,"contributors":[{"name":"jsonzhao","email":"json.zhao.cn@outlook.com","commits":1}]},"filePathRelative":"blogs/Skills/SQLServer/Funcation/DeepUnderstandingMerge.md"}');export{d as comp,c as data};
