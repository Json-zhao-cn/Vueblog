import{_ as s,c as a,a as e,o as t}from"./app-DZFgIm2e.js";const o={};function i(l,n){return t(),a("div",null,[...n[0]||(n[0]=[e(`<h3 id="sql-server-keyset-pagination" tabindex="-1"><a class="header-anchor" href="#sql-server-keyset-pagination"><span>SQL Server Keyset Pagination</span></a></h3><h4 id="why-we-need-the-keyset-pagination-in-the-sql-server" tabindex="-1"><a class="header-anchor" href="#why-we-need-the-keyset-pagination-in-the-sql-server"><span><strong>Why we need the Keyset Pagination in the SQL Server?</strong></span></a></h4><p>We use the Keyset Pagination to solve the performance problems of traditional pagination methods (such as OFFSET-FETCH) when dealing with large data sets.</p><ol><li>When we use the offset, it has two problems:</li></ol><ul><li><ol><li>SQL Server needs to scan and skip the first 10,000 lines;</li></ol></li><li><ol start="2"><li>As the OFFSET value increases, the performance decreases linearly</li></ol></li></ul><ol start="2"><li>Why Keyset Pagination?</li></ol><ul><li><ol><li><strong>Direct positioning</strong>: Directly locate to the starting position through the index;</li></ol></li><li><ol start="2"><li><strong>Avoid full scan</strong>: There is no need to scan and skip the previous rows;</li></ol></li><li><ol start="3"><li><strong>Index utilization</strong>: Make full use of the orderliness of indexes;</li></ol></li><li><ol start="4"><li><strong>Reduce I/O</strong></li></ol></li></ul><h4 id="how-to-do-it" tabindex="-1"><a class="header-anchor" href="#how-to-do-it"><span><strong>How to do it?</strong></span></a></h4><h5 id="_1-getmaxid-in-the-first-page" tabindex="-1"><a class="header-anchor" href="#_1-getmaxid-in-the-first-page"><span>1. GetMaxID in the first page</span></a></h5><ol><li>Get MaxID or MaxName in the first page, the primary key is best choose.Then, remember this current MaxID or MaxName;</li></ol><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>ID<span class="token punctuation">)</span> <span class="token keyword">AS</span> MaxID</span>
<span class="line"><span class="token keyword">FROM</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span> ID</span>
<span class="line">    <span class="token keyword">FROM</span> TabelA</span>
<span class="line">    <span class="token keyword">WHERE</span> ID <span class="token operator">&gt;</span> <span class="token number">0</span></span>
<span class="line">    <span class="token operator">AND</span> <span class="token keyword">COALESCE</span><span class="token punctuation">(</span>LastUpdateOn<span class="token punctuation">,</span> CreatedOn<span class="token punctuation">)</span> <span class="token operator">&gt;</span> DATEADD<span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> GETUTCDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> ID <span class="token keyword">ASC</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token keyword">AS</span> T<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-getmaxid-in-the-second-page" tabindex="-1"><a class="header-anchor" href="#_2-getmaxid-in-the-second-page"><span>2. GetMaxID in the second page</span></a></h4><ol><li>use first page MaxID as condition,Get MaxID in the second page, the primary key is best choose.Then, remember this current MaxID;</li></ol><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>ID<span class="token punctuation">)</span> <span class="token keyword">AS</span> MaxID</span>
<span class="line"><span class="token keyword">FROM</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span> ID</span>
<span class="line">    <span class="token keyword">FROM</span> TabelA</span>
<span class="line">    <span class="token keyword">WHERE</span> ID <span class="token operator">&gt;</span> <span class="token punctuation">(</span>MaxID<span class="token punctuation">)</span></span>
<span class="line">    <span class="token operator">AND</span> <span class="token keyword">COALESCE</span><span class="token punctuation">(</span>LastUpdateOn<span class="token punctuation">,</span> CreatedOn<span class="token punctuation">)</span> <span class="token operator">&gt;</span> DATEADD<span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> GETUTCDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> ID <span class="token keyword">ASC</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token keyword">AS</span> T<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-if-you-don-t-have-the-pk-in-your-table-you-can-find-the-mutiple-columns-as-pk-and-you-need-to-create-the-index-for-this" tabindex="-1"><a class="header-anchor" href="#_3-if-you-don-t-have-the-pk-in-your-table-you-can-find-the-mutiple-columns-as-pk-and-you-need-to-create-the-index-for-this"><span>3. If you don&#39;t have the PK in your table,you can find the mutiple columns as PK, and you need to create the index for this.</span></a></h4>`,15)])])}const r=s(o,[["render",i]]),c=JSON.parse('{"path":"/blogs/Skills/SQLServer/Paging/KeysetPagination.html","title":"SQL Server Keyset Pagination","lang":"en-US","frontmatter":{"title":"SQL Server Keyset Pagination","date":"2025/11/14","tags":["SQLServer"],"categories":["Skills"]},"headers":[{"level":3,"title":"SQL Server Keyset Pagination","slug":"sql-server-keyset-pagination","link":"#sql-server-keyset-pagination","children":[]}],"git":{"createdTime":1763103282000,"updatedTime":1763103282000,"contributors":[{"name":"jsonzhao","email":"json.zhao.cn@outlook.com","commits":1}]},"filePathRelative":"blogs/Skills/SQLServer/Paging/KeysetPagination.md"}');export{r as comp,c as data};
