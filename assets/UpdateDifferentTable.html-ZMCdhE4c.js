import{_ as s,c as a,a as e,o as p}from"./app-7xvXnEYb.js";const t={};function o(l,n){return p(),a("div",null,[...n[0]||(n[0]=[e(`<h4 id="update-the-different-table-in-the-sql-server" tabindex="-1"><a class="header-anchor" href="#update-the-different-table-in-the-sql-server"><span>Update the different table in the SQL Server</span></a></h4><ol><li><code>Requirement</code>: I want to update RESOURCE_ table WorkCenter based on the WIP_LINE_WORK_CENTER column WorkCenter. They are the different table.</li><li><code>Solution</code>: Update two different table, we can use SQL Server <code>row_number</code> function</li></ol><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">select</span> </span>
<span class="line">    a<span class="token punctuation">.</span>ID<span class="token punctuation">,</span></span>
<span class="line">	m<span class="token punctuation">.</span>id<span class="token punctuation">,</span></span>
<span class="line">    a<span class="token punctuation">.</span>workcenter<span class="token punctuation">,</span></span>
<span class="line">	n<span class="token punctuation">.</span>WorkCenter</span>
<span class="line"><span class="token comment">--update RESOURCE_</span></span>
<span class="line"><span class="token comment">--set WorkCenter=n.WorkCenter</span></span>
<span class="line"><span class="token keyword">from</span> RESOURCE_ a</span>
<span class="line"><span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> </span>
<span class="line">        row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>id <span class="token keyword">asc</span><span class="token punctuation">)</span> rownumber<span class="token punctuation">,</span></span>
<span class="line">        a<span class="token punctuation">.</span>ID<span class="token punctuation">,</span></span>
<span class="line">        A<span class="token punctuation">.</span>WorkCenter</span>
<span class="line">    <span class="token keyword">from</span> RESOURCE_ a </span>
<span class="line">    <span class="token keyword">where</span> a<span class="token punctuation">.</span>Active<span class="token operator">=</span><span class="token number">1</span></span>
<span class="line">    <span class="token operator">and</span> a<span class="token punctuation">.</span>Name <span class="token operator">like</span> <span class="token string">&#39;Carrier_T1%&#39;</span></span>
<span class="line">    <span class="token operator">and</span> a<span class="token punctuation">.</span>ProductionLine<span class="token operator">=</span><span class="token string">&#39;T1_TC1&#39;</span><span class="token punctuation">)</span> m <span class="token keyword">on</span> m<span class="token punctuation">.</span>ID<span class="token operator">=</span>a<span class="token punctuation">.</span>ID</span>
<span class="line"><span class="token keyword">join</span>  <span class="token punctuation">(</span><span class="token keyword">select</span> </span>
<span class="line">        row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> B<span class="token punctuation">.</span>GROUP_ <span class="token keyword">asc</span><span class="token punctuation">)</span> rownumber<span class="token punctuation">,</span></span>
<span class="line">        B<span class="token punctuation">.</span>WorkCenter</span>
<span class="line">    <span class="token keyword">from</span> WIP_LINE_WORK_CENTER a </span>
<span class="line">    <span class="token keyword">JOIN</span> WORK_CENTER_GROUP B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>WorkCenter<span class="token operator">=</span>B<span class="token punctuation">.</span>WorkCenter</span>
<span class="line">    <span class="token keyword">where</span> a<span class="token punctuation">.</span>ProductionLineNo<span class="token operator">=</span><span class="token string">&#39;T1_TC1&#39;</span></span>
<span class="line">    <span class="token operator">AND</span> B<span class="token punctuation">.</span>GroupType<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span> n <span class="token keyword">on</span> m<span class="token punctuation">.</span>rownumber<span class="token operator">=</span>n<span class="token punctuation">.</span>rownumber</span>
<span class="line"><span class="token keyword">where</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)])])}const i=s(t,[["render",o]]),r=JSON.parse('{"path":"/blogs/Skills/SQLServer/Tables/UpdateDifferentTable.html","title":"Update the different table in the SQL Server","lang":"en-US","frontmatter":{"title":"Update the different table in the SQL Server","date":"2025/11/14","tags":["SQLServer"],"categories":["Skills"]},"headers":[],"git":{"createdTime":1763103282000,"updatedTime":1763103282000,"contributors":[{"name":"jsonzhao","email":"json.zhao.cn@outlook.com","commits":1}]},"filePathRelative":"blogs/Skills/SQLServer/Tables/UpdateDifferentTable.md"}');export{i as comp,r as data};
