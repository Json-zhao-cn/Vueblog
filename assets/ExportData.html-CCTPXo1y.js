import{_ as s,c as a,a as t,o as p}from"./app-DZFgIm2e.js";const e={};function o(l,n){return p(),a("div",null,[...n[0]||(n[0]=[t(`<h2 id="input-the-source-db-table-data-to-target-db" tabindex="-1"><a class="header-anchor" href="#input-the-source-db-table-data-to-target-db"><span><strong>Input the source db table data to target db</strong></span></a></h2><p>Target DB table data is null</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pyodbc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Connection strings (adjust your server, user, password, db)</span></span>
<span class="line">src_conn_str <span class="token operator">=</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">&quot;DRIVER={ODBC Driver 17 for SQL Server};&quot;</span></span>
<span class="line">    <span class="token string">&quot;SERVER=ip;DATABASE=db;UID=user;PWD=ps&quot;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line">tgt_conn_str <span class="token operator">=</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">&quot;DRIVER={ODBC Driver 17 for SQL Server};&quot;</span></span>
<span class="line">    <span class="token string">&quot;SERVER=ip;DATABASE=db;UID=user;PWD=ps&quot;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Connect</span></span>
<span class="line">src_conn <span class="token operator">=</span> pyodbc<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>src_conn_str<span class="token punctuation">)</span></span>
<span class="line">tgt_conn <span class="token operator">=</span> pyodbc<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>tgt_conn_str<span class="token punctuation">)</span></span>
<span class="line">tgt_conn<span class="token punctuation">.</span>autocommit <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># manage commits manually</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Cursor</span></span>
<span class="line">src_cursor <span class="token operator">=</span> src_conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">tgt_cursor <span class="token operator">=</span> tgt_conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># List of tables to copy</span></span>
<span class="line">tables <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;TestA&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">batch_size <span class="token operator">=</span> <span class="token number">10000</span></span>
<span class="line"><span class="token keyword">for</span> table <span class="token keyword">in</span> tables<span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># Read data in chunks</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ðŸš€ Copying </span><span class="token interpolation"><span class="token punctuation">{</span>table<span class="token punctuation">}</span></span><span class="token string"> ...&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    src_cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;SELECT * FROM </span><span class="token interpolation"><span class="token punctuation">{</span>table<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&quot;[</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">]&quot;</span></span> <span class="token keyword">for</span> column <span class="token keyword">in</span> src_cursor<span class="token punctuation">.</span>description<span class="token punctuation">]</span>  <span class="token comment"># add []</span></span>
<span class="line">    placeholders <span class="token operator">=</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;?&quot;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>columns<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    insert_sql <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;INSERT INTO </span><span class="token interpolation"><span class="token punctuation">{</span>table<span class="token punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;,&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>columns<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">) VALUES (</span><span class="token interpolation"><span class="token punctuation">{</span>placeholders<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;âœ…</span><span class="token interpolation"><span class="token punctuation">{</span>insert_sql<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Enable fast executemany</span></span>
<span class="line">    tgt_cursor<span class="token punctuation">.</span>fast_executemany <span class="token operator">=</span> <span class="token boolean">True</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">        rows <span class="token operator">=</span> src_cursor<span class="token punctuation">.</span>fetchmany<span class="token punctuation">(</span>batch_size<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token keyword">not</span> rows<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">break</span></span>
<span class="line">        tgt_cursor<span class="token punctuation">.</span>executemany<span class="token punctuation">(</span>insert_sql<span class="token punctuation">,</span> rows<span class="token punctuation">)</span></span>
<span class="line">        tgt_conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Inserted </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> rows...&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;âœ… Finished </span><span class="token interpolation"><span class="token punctuation">{</span>table<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;âœ… Done inserting all rows!&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Cleanup</span></span>
<span class="line">src_cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">tgt_cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">src_conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">tgt_conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)])])}const i=s(e,[["render",o]]),u=JSON.parse('{"path":"/blogs/Skills/Python/ExportData.html","title":"Input the source db table data to target db","lang":"en-US","frontmatter":{"title":"Input the source db table data to target db","date":"2025/10/05","tags":["Python"],"categories":["Skills"]},"headers":[{"level":2,"title":"Input the source db table data to target db","slug":"input-the-source-db-table-data-to-target-db","link":"#input-the-source-db-table-data-to-target-db","children":[]}],"git":{"createdTime":1763109587000,"updatedTime":1763109587000,"contributors":[{"name":"jsonzhao","email":"json.zhao.cn@outlook.com","commits":1}]},"filePathRelative":"blogs/Skills/Python/ExportData.md"}');export{i as comp,u as data};
